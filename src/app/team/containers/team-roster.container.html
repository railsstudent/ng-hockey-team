<div class="team-container">
  <ng-container *ngIf="(team$ | async) as team">
    <header class="heading">
      <a (click)="returnToMenu()" aria-label="Return to team menu">
        <i class="fas fa-chevron-circle-left fa-3x"></i>
      </a>
      <div class="title">
        <span class="center">{{ team.division }} - {{ team.name }}</span>
      </div>
      <span class="spacer"></span>
    </header>
    <section class="roster-container">
      <ng-container *ngIf="{ msg: error$ | async, hideError: hideError$ | async } as error">
        <div class="alert alert-danger team-alert" role="alert" *ngIf="error.msg && !error.hideError">
          <div class="alert-items">
            <div class="alert-item static">
              <div class="alert-icon-wrapper">
                <i class="fas fa-info-circle"></i>
              </div>
              <span class="alert-text">{{ error.msg }}</span>
            </div>
          </div>
          <button type="button" class="close" aria-label="Close" (click)="closeAlert()">
            <i class="fas fa-times-circle"></i>
          </button>
        </div>
      </ng-container>
      <section class="main-content">
        <ng-container *ngIf="(isSmallScreen$ | async); else horizontalTable">
          <team-stat-vertical-table
            [team]="team"
            (updateWin)="updateWin$.next($event)"
            (updateLoss)="updateLoss$.next($event)"
            (updateDraw)="updateDraw$.next($event)"
            (updateOvertimeWin)="updateOvertimeWin$.next($event)"
            (updateOvertimeLoss)="updateOvertimeLoss$.next($event)"
            (updateGoalsFor)="updateGoalsFor$.next($event)"
            (updateGoalsAgainst)="updateGoalsAgainst$.next($event)"
            [overtimeArrowsVisible]="team.numDraw > team.numOTWin + team.numOTLoss"
            [goalsForVisible]="team.numWin + team.numLoss + team.numDraw > 0"
            [goalsAgainstVisible]="team.numWin + team.numLoss + team.numDraw > 0"
          ></team-stat-vertical-table>
        </ng-container>
        <!-- <div class="player-container"></div> -->
        <team-tables>
          <team-standing-table
            [headerTemplateRef]="leaderHeaderTemplate"
            [teamsTemplateRef]="leaderTemplate"
            [titleTemplateRef]="titleTemplate"
          >
          </team-standing-table>

          <ng-template #titleTemplate>
            <p class="standing-table-title">{{ team.division + ' Division' }}</p>
          </ng-template>

          <ng-template #leaderHeaderTemplate>
            <th class="left">Name</th>
            <th class="left">Games Played</th>
            <th class="left">Points</th>
          </ng-template>

          <ng-template #leaderTemplate>
            <tr *ngFor="let team of (currentDivision$ | async)">
              <td class="left">
                <a href (click)="$event.preventDefault(); $event.stopPropagation(); gotoTeam(team.id)"
                  >{{ team.name }}</a
                >
              </td>
              <td class="left">{{ team.gamesPlayed }}</td>
              <td class="left">{{ team.points }}</td>
            </tr>
          </ng-template>
        </team-tables>
      </section>
    </section>
    <ng-template #horizontalTable>
      <team-stat-horizontal-table
        [team]="team"
        (updateWin)="updateWin$.next($event)"
        (updateLoss)="updateLoss$.next($event)"
        (updateDraw)="updateDraw$.next($event)"
        (updateOvertimeWin)="updateOvertimeWin$.next($event)"
        (updateOvertimeLoss)="updateOvertimeLoss$.next($event)"
        (updateGoalsFor)="updateGoalsFor$.next($event)"
        (updateGoalsAgainst)="updateGoalsAgainst$.next($event)"
        [overtimeArrowsVisible]="team.numDraw > team.numOTWin + team.numOTLoss"
        [goalsForVisible]="team.numWin + team.numLoss + team.numDraw > 0"
        [goalsAgainstVisible]="team.numWin + team.numLoss + team.numDraw > 0"
      ></team-stat-horizontal-table>
    </ng-template>
  </ng-container>
</div>
